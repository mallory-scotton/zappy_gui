///////////////////////////////////////////////////////////////////////////////
// Dependencies
///////////////////////////////////////////////////////////////////////////////
#include "Core/Application.hpp"
#include "Errors/NetworkException.hpp"

///////////////////////////////////////////////////////////////////////////////
// Namespace Zappy
///////////////////////////////////////////////////////////////////////////////
namespace Zappy
{

///////////////////////////////////////////////////////////////////////////////
Application::Application(const std::string& host, int port)
{
    GameState& state = GameState::GetInstance();

    if (!state.Connect(host, port))
    {
        throw NetworkException("Failed to connect to the game server");
    }

    m_renderer = std::make_unique<Renderer>();
}

///////////////////////////////////////////////////////////////////////////////
bool Application::IsOpen(void) const
{
    return (m_renderer && m_renderer->IsOpen());
}

///////////////////////////////////////////////////////////////////////////////
void Application::Update(void)
{
    GameState& gs = GameState::GetInstance();

    gs.Update();
    m_renderer->Update();
    m_renderer->Display();
}

} // !namespace Zappy
